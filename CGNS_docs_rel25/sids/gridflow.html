<!-- CGNS SIDS document - Grid Coordinates, Elements, and Flow Solutions -->

<html>
<head>
<meta http-equiv="Content-Style-Type" content="text/css">
<link href="sids.css" rel="stylesheet" type="text/css">
<title> CGNS Standard Interface Data Structures - Grid Coordinates, Elements, and Flow Solutions </title>
</head>

<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B" alink="#FF0000">

<a href="#endnav"><img src="../blank.gif" border=0 alt="Skip navigation links"></a>
<small>
<center>
(<a href="../index.html"><b>CGNS&nbsp;Documentation&nbsp;Home&nbsp;Page</b></a>)
(<a href="../charter/index.html"><b>Steering&nbsp;Committee&nbsp;Charter</b></a>)
(<a href="../overview/index.html"><b>Overview&nbsp;and&nbsp;Entry-Level&nbsp;Document</b></a>)
(<a href="../user/index.html"><b>A&nbsp;User's&nbsp;Guide&nbsp;to&nbsp;CGNS</b></a>)
(<a href="index.html"><span class=nav><b>Standard&nbsp;Interface&nbsp;Data&nbsp;Structures</b></span></a>)
(<a href="../filemap/index.html"><b>SIDS-to-ADF&nbsp;File&nbsp;Mapping&nbsp;Manual</b></a>)
(<a href="../filemap_hdf/index.html"><b>SIDS-to-HDF&nbsp;File&nbsp;Mapping&nbsp;Manual</b></a>)
(<a href="../midlevel/index.html"><b>Mid-Level&nbsp;Library</b></a>)
(<a href="../adf/index.html"><b>ADF&nbsp;User's&nbsp;Guide</b></a>)
(<a href="../cgnstools/index.html"><b>CGNS&nbsp;Tools&nbsp;and&nbsp;Utilities</b></a>)
<br><br>
(<a href="intro.html"><b>Introduction</b></a>)
(<a href="design.html"><b>Design&nbsp;Philosophy&nbsp;of&nbsp;Standard&nbsp;Interface&nbsp;Data&nbsp;Structures</b></a>)
(<a href="conv.html"><b>Conventions</b></a>)
(<a href="build.html"><b>Building-Block&nbsp;Structure&nbsp;Definitions</b></a>)
(<a href="data.html"><b>Data-Array&nbsp;Structure&nbsp;Definitions</b></a>)
(<a href="cgnsbase.html"><b>Hierarchical&nbsp;Structures</b></a>)
(<span class=nav><b>Grid&nbsp;Coordinates,&nbsp;Elements,&nbsp;and&nbsp;Flow&nbsp;Solution</b></span>)
(<a href="cnct.html"><b>Multizone&nbsp;Interface&nbsp;Connectivity</b></a>)
(<a href="bc.html"><b>Boundary&nbsp;Conditions</b></a>)
(<a href="floweqn.html"><b>Governing&nbsp;Flow&nbsp;Equations</b></a>)
(<a href="timedep.html"><b>Time-Dependent&nbsp;Flow</b></a>)
(<a href="misc.html"><b>Miscellaneous&nbsp;Data&nbsp;Structures</b></a>)
(<a href="dataname.html"><b>Conventions&nbsp;for&nbsp;Data-Name&nbsp;Identifiers</b></a>)
(<a href="twozone.html"><b>Structured&nbsp;Two-Zone&nbsp;Flat&nbsp;Plate&nbsp;Example</b></a>)
</center>
</small>
<a name="endnav"></a>

<h2>Grid Coordinates, Elements, and Flow Solutions</h2>

<ul>
<li> <a href="#GridCoordinates">Grid Coordinates Structure Definition: <tt>GridCoordinates_t</tt></a>
<li> <a href="#grid_example">Grid Coordinates Examples</a>
<li> <a href="#Elements">Elements Structure Definition: <tt>Elements_t</tt></a>
<li> <a href="#element_example">Elements Examples</a>
<li> <a href="#Axisymmetry">Axisymmetry Structure Definition: <tt>Axisymmetry_t</tt></a>
<li> <a href="#RotatingCoordinates">Rotating Coordinates Structure Definition: <tt>RotatingCoordinates_t</tt></a>
<li> <a href="#FlowSolution">Flow Solution Structure Definition: <tt>FlowSolution_t</tt></a>
<li> <a href="#flow_example">Flow Solution Example</a>
</ul>

<p>
This section defines structure types for describing the grid
coordinates, element data, and flow solution data pertaining to a zone.
Entities of each of the structure types defined in this section are
contained in the <a href="cgnsbase.html#Zone"><tt>Zone_t</tt></a> structure.

<a name="GridCoordinates"></a>
<h3>Grid Coordinates Structure Definition: <tt>GridCoordinates_t</tt></h3>

<p>
The physical coordinates of the grid vertices are described by the 
<tt>GridCoordinates_t</tt> structure.
This structure contains a list for the data arrays of the individual
components of the position vector.
It also provides a mechanism for identifying rind-point data included
within the position-vector arrays.
<pre>
  GridCoordinates_t&lt; int IndexDimension, int VertexSize[IndexDimension] &gt; :=
    {
    List( Descriptor_t Descriptor1 ... DescriptorN ) ;                 (o)
 
    Rind_t&lt;IndexDimension&gt; Rind ;                                      (o/d)

    List( DataArray_t&lt;DataType, IndexDimension, DataSize[]&gt; 
          DataArray1 ... DataArrayN ) ;                                (o)

    DataClass_t DataClass ;                                            (o)
    
    DimensionalUnits_t DimensionalUnits ;                              (o)

    List( UserDefinedData_t UserDefinedData1 ... UserDefinedDataN ) ;  (o)
    } ;
</pre>

<i>Notes</i>

<ol>
<li> Default names for the
     <a href="build.html#Descriptor"><tt>Descriptor_t</tt></a>,
     <a href="data.html#DataArray"><tt>DataArray_t</tt></a>, and
     <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
     lists are
     as shown; users may choose other legitimate names.
     Legitimate names must be unique within a given instance of
     <tt>GridCoordinates_t</tt> and shall not include the names
     <tt>DataClass</tt>, <tt>DimensionalUnits</tt>, or <tt>Rind</tt>.
<li> There are no required fields for <tt>GridCoordinates_t</tt>.
     <a href="build.html#Rind"><tt>Rind</tt></a> has a default if absent;
     the default is equivalent to having a <tt>Rind</tt> structure
     whose <tt>RindPlanes</tt> array contains all zeros.
<li> The structure parameter <tt>DataType</tt> must be consistent
     with the data stored in the
     <a href="data.html#DataArray"><tt>DataArray_t</tt></a> substructures.
</ol>

<p>
<tt>GridCoordinates_t</tt> requires two structure parameters:
<tt>IndexDimension</tt> identifies the dimensionality of the grid-size
arrays, and <tt>VertexSize</tt> is the number of vertices in each index
direction excluding rind points.
For unstructured zones, <tt>IndexDimension</tt> is always 1 and
<tt>VertexSize</tt> is the total number of vertices, excluding rind
points.

<p>
The grid-coordinates data is stored in the list of
<a href="data.html#DataArray"><tt>DataArray_t</tt></a>
entities; each <tt>DataArray_t</tt> structure entity may contain
a single component of the position vector (e.g., three separate
<tt>DataArray_t</tt> entities are used for <i>x</i>, <i>y</i>, and
<i>z</i>).

<p>
Standardized data-name identifiers for the grid coordinates are
described in <a href="dataname.html#dataname_grid">Conventions for
Data-Name Identifiers</a>.

<p>
<a href="build.html#Rind"><tt>Rind</tt></a> is an optional field that
indicates the number of rind planes (for structured grids) or rind
points (for unstructured grids) included in the grid-coordinates data.
If <tt>Rind</tt> is absent, then the
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> structure
entities contain only "core" vertices of a zone; core refers to all
interior and bounding vertices of a zone - <tt>VertexSize</tt> is the
number of core vertices.
Core vertices in a zone are assumed to begin at <tt>[1,1,1]</tt> (for
a structured zone in 3-D) and end at <tt>VertexSize</tt>.
If <tt>Rind</tt> is present, it will provide information on the number
of "rind" points in addition to the core points that are contained in
the <tt>DataArray_t</tt> structures.

<p>
<a href="build.html#DataClass"><tt>DataClass</tt></a> defines the
default class for data contained in the
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> entities.
For dimensional grid coordinates,
<a href="build.html#DimensionalUnits"><tt>DimensionalUnits</tt></a>
may be used to describe the system of units employed.
If present, these two entities take precedence over the corresponding
entities at higher levels of the CGNS hierarchy, following the
standard <a href="cgnsbase.html#precedence">precedence rules</a>.
An example that uses these grid-coordinate defaults is shown under
<a href="#grid_example">Grid Coordinates Examples</a>.

<p>
The <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
data structure allows arbitrary user-defined data to be stored in
<tt>Descriptor_t</tt> and <tt>DataArray_t</tt> children without the
restrictions or implicit meanings imposed on these node types at other
node locations.

<a name="DataSize_grid"></a>
<h4>FUNCTION <tt>DataSize[]</tt>:</h4>

return value: one-dimensional <tt>int</tt> array of length <tt>IndexDimension</tt>
<br>
dependencies: <tt>IndexDimension</tt>, <tt>VertexSize[]</tt>, <tt>Rind</tt>

<p>
<tt>GridCoordinates_t</tt> requires a single structure function, named
<tt>DataSize</tt>, to identify the array sizes of the grid-coordinates
data.
A function is required for the following reasons:

<ul>
<li> the entire grid, including both core and rind points, is stored
     in the <a href="data.html#DataArray"><tt>DataArray_t</tt></a> entities;
<li> the <tt>DataArray_t</tt> structure is simple in that it doesn't
     know anything about core versus rind data; it just knows that
     it contains data of some given size;
<li> to make all the <tt>DataArray_t</tt> entities syntactically
     consistent in their size (i.e., by syntax entities containing
     <i>x</i>, <i>y</i> and <i>z</i> must have the same dimensionality
     and dimension sizes), the size of the array is passed onto the
     <tt>DataArray_t</tt> structure as a parameter.
</ul>

<pre>
  if (Rind is absent) then
    {
    DataSize[] = VertexSize[] ;
    }
  else if (Rind is present) then
    { 
    DataSize[] = VertexSize[] + [a + b,...] ;
    }
</pre>
where <tt>RindPlanes = [a,b,...]</tt> (see the
<a href="build.html#Rind"><tt>Rind_t</tt></a> structure for the     
definition of <tt>RindPlanes</tt>).

<a name="grid_example"></a>
<h3>Grid Coordinates Examples</h3>

<p>
This section contains examples of grid coordinates.
These examples show the storage of the grid-coordinate data arrays, as
well as different mechanisms for describing the class of data and the
system of units or normalization.

<a name="ex:grid1"></a>
<h4>Example - Cartesian Coordinates for a 2-D Structured Grid</h4>

<p>
Cartesian coordinates for a 2-D grid of size 17 &times; 33; the data
arrays include only core vertices, and the coordinates are in units of
feet.
<pre>
  !  IndexDimension = 2
  !  VertexSize = [17,33]
  GridCoordinates_t&lt;2, [17,33]&gt; GridCoordinates =
    {{
    DataArray_t&lt;real, 2, [17,33]&gt; CoordinateX =
      {{
      Data(real, 2, [17,33]) = ((x(i,j), i=1,17), j=1,33) ;

      DataClass_t DataClass = Dimensional ;
      
      DimensionalUnits_t DimensionalUnits = 
        {{ 
        MassUnits        = Null ;
        LengthUnits      = Foot ;
        TimeUnits        = Null ;
        TemperatureUnits = Null ;
        AngleUnits       = Null ;
        }} ;
      }} ;

    DataArray_t&lt;real, 2, [17,33]&gt; CoordinateY =
      {{
      Data(real, 2, [17,33]) = ((y(i,j), i=1,17), j=1,33) ;

      DataClass_t DataClass = Dimensional ;
      
      DimensionalUnits_t DimensionalUnits = 
        {{ 
        MassUnits        = Null ;
        LengthUnits      = Foot ;
        TimeUnits        = Null ;
        TemperatureUnits = Null ;
        AngleUnits       = Null ;
        }} ;
      }} ;
    }} ;
</pre>
From the <a href="dataname.html">Conventions for Data-Name Identifiers</a>,
the identifiers
for <i>x</i> and <i>y</i> are <tt>CoordinateX</tt> and <tt>CoordinateY</tt>,
respectively, and both have a data type of <tt>real</tt>.
The value of <a href="build.html#DataClass"><tt>DataClass</tt></a>
in <tt>CoordinateX</tt> and <tt>CoordinateY</tt> indicate the data is
dimensional, and
<a href="build.html#DimensionalUnits"><tt>DimensionalUnits</tt></a>
specifies the appropriate units are feet.
The <a href="build.html#DimensionalExponents"><tt>DimensionalExponents</tt></a>
entity is absent from both <tt>CoordinateX</tt> and <tt>CoordinateY</tt>;
the information that <i>x</i> and <i>y</i> are lengths can be inferred
from the <a href="dataname.html#dataname_grid">data-name identifier
conventions for coordinate systems</a>.

<p>
Note that FORTRAN multidimensional array indexing is used to store
the data; this is reflected in the FORTRAN-like implied do-loops for
<tt>x(i,j)</tt> and <tt>y(i,j)</tt>.

<p>
Since the dimensional units for both <i>x</i> and <i>y</i> are the same, an
alternate approach is to set the data class and system of units
using <a href="build.html#DataClass"><tt>DataClass</tt></a> and
<a href="build.html#DimensionalUnits"><tt>DimensionalUnits</tt></a> at the
<a href="#GridCoordinates"><tt>GridCoordinates_t</tt></a> level, and
eliminate this information from each instance of
<a href="data.html#DataArray"><tt>DataArray_t</tt></a>.
<pre>
  GridCoordinates_t&lt;2, [17,33]&gt; GridCoordinates =
    {{
    DataClass_t DataClass = Dimensional ;
    
    DimensionalUnits_t DimensionalUnits = 
      {{ 
      MassUnits        = Null ;
      LengthUnits      = Foot ;
      TimeUnits        = Null ;
      TemperatureUnits = Null ;
      AngleUnits       = Null ;
      }} ;

    DataArray_t&lt;real, 2, [17,33]&gt; CoordinateX =
      {{
      Data(real, 2, [17,33]) = ((x(i,j), i=1,17), j=1,33) ;
      }} ;

    DataArray_t&lt;real, 2, [17,33]&gt; CoordinateY =
      {{
      Data(real, 2, [17,33]) = ((y(i,j), i=1,17), j=1,33) ;
      }} ;
    }} ;
</pre>
Since the <a href="build.html#DataClass"><tt>DataClass</tt></a> and
<a href="build.html#DimensionalUnits"><tt>DimensionalUnits</tt></a>
entities are not present in <tt>CoordinateX</tt> and <tt>CoordinateY</tt>,
the established <a href="data.html#dim">rules for dimensional data</a>
dictate that <tt>DataClass</tt> and <tt>DimensionalUnits</tt> specified
at the <a href="#GridCoordinates"><tt>GridCoordinates_t</tt></a>
level be used to retrieve the information.

<a name="ex:grid2"></a>
<h4>Example - Cylindrical Coordinates for a 3-D Structured Grid</h4>

<p>
Cylindrical coordinates for a 3-D grid whose core size is
17 &times; 33 &times; 9.
The grid contains a single plane of rind on the minimum and maximum
<i>k</i> faces.
The coordinates are nondimensional.
<pre>
  !  IndexDimension = 3
  !  VertexSize = [17,33,9]
  GridCoordinates_t&lt;3, [17,33,9]&gt; GridCoordinates =
    {{
    Rind_t&lt;3&gt; Rind =
      {{
      int[6] RindPlanes = [0,0,0,0,1,1] ;
      }} ;

    ! DataType = real
    ! IndexDimension = 3
    ! DataSize = VertexSize + [0,0,2] = [17,33,11]
    DataArray_t&lt;real, 3, [17,33,11]&gt; CoordinateRadius =
      {{
      Data(real, 3, [17,33,11]) = (((r(i,j,k), i=1,17), j=1,33), k=0,10) ;

      DataClass_t DataClass = NormalizedByUnknownDimensional ;
      }} ;

    DataArray_t&lt;real, 3, [17,33,11]&gt; CoordinateZ     = {{ }} ;
    DataArray_t&lt;real, 3, [17,33,11]&gt; CoordinateTheta = {{ }} ;
    }} ;
</pre>
The value of <tt>RindPlanes</tt> specifies two rind planes on the
minimum and maximum <i>k</i> faces.
These rind planes are reflected in the structure function
<a href="#DataSize_grid"><tt>DataSize</tt></a> which is equal to the number
of core vertices plus two in the <i>k</i> dimension.
The value of <tt>DataSize</tt> is passed to the
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> entities.
The value of <a href="build.html#DataClass"><tt>DataClass</tt></a>
indicates the data is nondimensional.
Note that if <tt>DataClass</tt> is set as
<tt>NormalizedByUnknownDimensional</tt> at a higher level
(<a href="cgnsbase.html#CGNSBase"><tt>CGNSBase_t</tt></a> or
<a href="cgnsbase.html#Zone"><tt>Zone_t</tt></a>), then it is not
needed here.

<p>
Note that the entities <tt>CoordinateZ</tt> and <tt>CoordinateTheta</tt>
are abbreviated.

<a name="ex:grid3"></a>
<h4>Example - Cartesian Coordinates for a 3-D Unstructured Grid</h4>

<p>
Cartesian grid coordinates for a 3-D unstructured zone where
<tt>VertexSize</tt> is 15.
<pre>
  GridCoordinates_t&lt;1, 15&gt; GridCoordinates =
    {{

    ! DataType = real
    ! IndexDimension = 1
    ! DataSize = VertexSize = 15
    DataArray_t&lt;real, 1, 15&gt; CoordinateX =
      {{
      Data(real, 1, 15) = (x(i), i=1,15) ;
      }} ;

    DataArray_t&lt;real, 1, 15&gt; CoordinateY =
      {{
      Data(real, 1, 15) = (y(i), i=1,15) ;
      }} ;

    DataArray_t&lt;real, 1, 15&gt; CoordinateZ =
      {{
      Data(real, 1, 15) = (z(i), i=1,15) ;
      }} ;
    }} ;
</pre>

<a name="Elements"></a>
<h3>Elements Structure Definition: <tt>Elements_t</tt></h3>

<p>
The <tt>Elements_t</tt> data structure is required for unstructured
zones, and contains the element connectivity data, the element type,
the element range, the parent elements data, and the number of boundary
elements.

<pre>
  Elements_t :=
    {
    List( Descriptor_t Descriptor1 ... DescriptorN ) ;                 (o)
 
    Rind_t&lt;IndexDimension&gt; Rind ;                                      (o/d)

    IndexRange_t ElementRange ;                                        (r)

    int ElementSizeBoundary ;                                          (o/d)

    ElementType_t ElementType ;                                        (r)

    DataArray_t&lt;int, 1, ElementDataSize&gt; ElementConnectivity ;         (r)

    DataArray_t&lt;int, 2, [ElementSize, 4]&gt; ParentData;                  (o)

    List( UserDefinedData_t UserDefinedData1 ... UserDefinedDataN ) ;  (o)
    } ;
</pre>

<i>Notes</i>

<ol>
<li> Default names for the
     <a href="build.html#Descriptor"><tt>Descriptor_t</tt></a> and
     <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
     lists are
     as shown; users may choose other legitimate names.
     Legitimate names must be unique within a given instance
     of <tt>Elements_t</tt> and shall not include the names
     <tt>ElementConnectivity</tt>, <tt>ElementRange</tt>,
     <tt>ParentData</tt>, or <tt>Rind</tt>.
<li> <a href="build.html#IndexRange"><tt>IndexRange_t</tt></a>,
     <a href="#ElementType"><tt>ElementType_t</tt></a>, and
     <a href="#ElementConnectivity"><tt>ElementConnectivity</tt></a>
     are the required fields within the <tt>Elements_t</tt> structure.
     <a href="build.html#Rind"><tt>Rind</tt></a> has a default if absent;
     the default is equivalent to having a <tt>Rind</tt> structure
     whose <tt>RindPlanes</tt> array contains all zeros.
</ol>

<p>
<a href="build.html#Rind"><tt>Rind</tt></a> is an optional field that
indicates the number of rind elements included in the elements data.
If <tt>Rind</tt> is absent, then the
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> structure
entities contain only core elements of a zone.
If <tt>Rind</tt> is present, it will provide information on the number
of rind elements, in addition to the core elements, that are contained
in the <tt>DataArray_t</tt> structures.

<p>
Note that the usage of rind data with respect to the size of the
<tt>DataArray_t</tt> structures is different under <tt>Elements_t</tt>
than elsewhere.
For example, when rind coordinate data is stored under
<a href="#GridCoordinates"><tt>GridCoordinates_t</tt></a>, the parameter
<tt>VertexSize</tt> accounts for the core data only.
The size of the <tt>DataArray_t</tt> structures containing the grid
coordinates is determined by the <tt>DataSize</tt> function, which adds
the number of rind planes or points to <tt>VertexSize</tt>.
But for the element connectivity, the size of the <tt>DataArray_t</tt>
structures containing the connectivity data is just
<tt>ElementDataSize</tt>, which depends on <tt>ElementSize</tt>, and
includes both the core and rind elements.

<p>
<tt>ElementRange</tt> contains the index of the first and last elements
defined in <a href="#ElementConnectivity"><tt>ElementConnectivity</tt></a>.
The elements are indexed with a global numbering system, starting at 1,
for all element sections under a given
<a href="cgnsbase.html#Zone"><tt>Zone_t</tt></a> data structure.
The global numbering insures that each element, whether it's a cell,
a face, or an edge, is uniquely identified by its number.
They are also listed as a continuous list of element numbers within any
single element section.
Therefore the number of elements in a section is:

<pre>
  ElementSize = ElementRange.end - ElementRange.start + 1
</pre>

<p>
The element indices are used for the boundary condition and zone
connectivity definition.

<p>
<tt>ElementSizeBoundary</tt> indicates if the elements are sorted, and how
many boundary elements are recorded.
By default, <tt>ElementSizeBoundary</tt> is set to zero, indicating that
the elements are not sorted.
If the elements are sorted, <tt>ElementSizeBoundary</tt> is set to the
number of elements at the boundary.
Consequently:

<pre>
  ElementSizeInterior = ElementSize - ElementSizeBoundary
</pre>

<a name="ElementType"></a>
<p>
<tt>ElementType_t</tt> is an enumeration of the supported element types:

<pre>
  ElementType_t := Enumeration(
     Null, NODE, BAR_2, BAR_3,
     TRI_3, TRI_6, QUAD_4, QUAD_8, QUAD_9,
     TETRA_4, TETRA_10, PYRA_5, PYRA_14,
     PENTA_6, PENTA_15, PENTA_18, 
     HEXA_8, HEXA_20, HEXA_27, MIXED, NGON_n, UserDefined );
</pre>
The conventions for element numbering for the various supported types
are described in <a href="conv.html#unstructgrid">Unstructured Grid
Element Numbering Conventions</a>.

<a name="ElementConnectivity"></a>
<p>
For all element types except type <tt>MIXED</tt>,
<tt>ElementConnectivity</tt> contains the list of nodes for each element.
If the elements are sorted, then it must first list the connectivity of
the boundary elements, then that of the interior elements.

<pre>
  ElementConnectivity = Node1<sub>1</sub>, Node2<sub>1</sub>, ... NodeN<sub>1</sub>,
                        Node1<sub>2</sub>, Node2<sub>2</sub>, ... NodeN<sub>2</sub>,
                        ...
                        Node1<sub>M</sub>, Node2<sub>M</sub>, ... NodeN<sub>M</sub>
</pre>

<p>
When the section <tt>ElementType</tt> is <tt>MIXED</tt>, the data array
<tt>ElementConnectivity</tt> contains one extra integer per element, to
hold each individual element type:

<pre>
  ElementConnectivity = Etype<sub>1</sub>, Node1<sub>1</sub>, Node2<sub>1</sub>, ... NodeN<sub>1</sub>,
                        Etype<sub>2</sub>, Node1<sub>2</sub>, Node2<sub>2</sub>, ... NodeN<sub>2</sub>,
                        ...
                        Etype<sub>M</sub>, Node1<sub>M</sub>, Node2<sub>M</sub>, ... NodeN<sub>M</sub>
</pre>

<p>
<tt>ElementDataSize</tt> indicates the size (number of integers) of the
array <tt>ElementConnectivity</tt>.
For all element types except type <tt>MIXED</tt>, the
<tt>ElementDataSize</tt> is given by:

<pre>
  ElementDataSize = ElementSize * NPE[ElementType]
</pre>

<p>
In the case of <tt>MIXED</tt> element section, <tt>ElementDataSize</tt> is
given by:

<br><br>
<tt>&nbsp;&nbsp;ElementDataSize</tt> =
&sum;
(<tt>NPE[ElementType</tt><sub><i>n</i></sub><tt>] + 1</tt>)
<br><br>
where the summation is over <i>n</i>, and <i>n</i> represents a specific
element type.

<p>
<tt>NPE[ElementType]</tt> is a function returning the number of nodes for
the given <tt>ElementType</tt>.
For example, <tt>NPE[HEXA_8]=8</tt>.

<p>
For face elements in 3D, or bar element in 2D, four more data may be
saved for each element - the corresponding parents' element number,
and the face position within these parent elements.
At the boundaries, the second parent is set to zero.

<p>
<tt>NGON_n</tt> is used to express a polygon of <i>n</i> nodes.
In order to record the number of nodes of any ngons, the
<a href="#ElementType"><tt>ElementType</tt></a> must be set to
<tt>NGON_n + Nnodes</tt>.
For example, for an element type <tt>NGON_n</tt> composed of 25 nodes, one
would set the <tt>ElementType</tt> to <tt>NGON_n + 25</tt>.

<p>
The <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
data structure allows arbitrary user-defined data to be stored in
<tt>Descriptor_t</tt> and <tt>DataArray_t</tt> children without the
restrictions or implicit meanings imposed on these node types at other
node locations.

<a name="element_example"></a>
<h3>Elements Examples</h3>

<p>
This section contains two examples of elements definition in CGNS.
In both cases, the unstructured zone contains 15 tetrahedral and 10
hexahedral elements.

<a name="ex:elements1"></a>
<h4>Example - Unstructured Elements, Separate Element Types</h4>

<p>
In this first example, the elements are written in two separate
sections, one for the tetrahedral elements and one for the hexahedral
elements.
<pre>
  Zone_t UnstructuredZone =
    {{
    Elements_t TetraElements =
      {{
      IndexRange_t ElementRange = [1,15] ;

      int ElementSizeBoundary = 10 ;

      ElementType_t ElementType = TETRA_4 ;

      DataArray_t&lt;int, 1, NPE[TETRA_4] &times; 15&gt; ElementConnectivity =
        {{
        Data(int, 1, NPE[TETRA_4] &times; 15) = (node(i,j), i=1,NPE[TETRA_4], j=1,15) ;
        }} ;
      }} ;
    Elements_t HexaElements =
      {{
      IndexRange_t ElementRange = [16,25] ;

      int ElementSizeBoundary = 0 ;

      ElementType_t ElementType = HEXA_8 ;

      DataArray_t&lt;int, 1, NPE[HEXA_8] &times; 10&gt; ElementConnectivity =
        {{
        Data(int, 1, NPE[HEXA_8] &times; 10) = (node(i,j), i=1,NPE[HEXA_8], j=1,10) ;
        }} ;
      }} ;
    }} ;
</pre>

<a name="ex:elements2"></a>
<h4>Example - Unstructured Elements, Element Type <tt>MIXED</tt></h4>

<p>
In this second example, the same unstructured zone described in
the <a href="#ex:elements1">example for separate element types</a>
is written in a
single element section of type <tt>MIXED</tt> (i.e., an unstructured grid
composed of mixed elements).
<pre>
  Zone_t UnstructuredZone =
    {{
    Elements_t MixedElementsSection =
      {{
      IndexRange_t ElementRange = [1,25] ;

      ElementType_t ElementType = MIXED ;

      DataArray_t&lt;int, 1, ElementDataSize&gt; ElementConnectivity =
        {{
        Data(int, 1, ElementDataSize) = (etype(j),(node(i,j),
             i=1,NPE[etype(j)]), j=1,25) ;
        }} ;
      }} ;
    }} ;
</pre>

<a name="Axisymmetry"></a>
<h3>Axisymmetry Structure Definition: <tt>Axisymmetry_t</tt></h3>

<p>
The <tt>Axisymmetry_t</tt> data structure allows recording the axis of
rotation and the angle of rotation around this axis for a two-dimensional
dataset that represents an axisymmetric database.

<pre>
  Axisymmetry_t :=
    {
    List( Descriptor_t Descriptor1 ... DescriptorN ) ;                 (o)

    DataArray_t&lt;real,1,2&gt; AxisymmetryReferencePoint ;                  (r)
    DataArray_t&lt;real,1,2&gt; AxisymmetryAxisVector ;                      (r)
    DataArray_t&lt;real,1,1&gt; AxisymmetryAngle ;                           (o)
    DataArray_t&lt;char,2,[32,2]&gt; CoordinateNames ;                       (o)

    DataClass_t DataClass ;                                            (o)

    DimensionalUnits_t DimensionalUnits ;                              (o)

    List( UserDefinedData_t UserDefinedData1 ... UserDefinedDataN ) ;  (o)
    } ;
</pre>

<i>Notes</i>

<ol>
<li> Default names for the
     <a href="build.html#Descriptor"><tt>Descriptor_t</tt></a> and
     <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
     lists are as shown; users may choose other legitimate names.
     Legitimate names must be unique within a given instance
     of <tt>Axisymmetry_t</tt> and shall not include the names
     <tt>AxisymmetryAngle</tt>, <tt>AxisymmetryAxisVector</tt>,
     <tt>AxisymmetryReferencePoint</tt>, <tt>CoordinateNames</tt>,
     <tt>DataClass</tt>, or <tt>DimensionalUnits</tt>.
<li> <tt>AxisymmetryReferencePoint</tt> and <tt>AxisymmetryAxisVector</tt>
     are the required fields within the <tt>Axisymmetry_t</tt> structure.
</ol>

<p>
<tt>AxisymmetryReferencePoint</tt> specifies the origin used for
defining the axis of rotation.

<p>
<tt>AxisymmetryAxisVector</tt> contains the direction cosines of the
axis of rotation, through the <tt>AxisymmetryReferencePoint</tt>.
For example, for a 2-D dataset defined in the (<i>x,y</i>) plane,
if <tt>AxisymmetryReferencePoint</tt> contains (0,0) and
<tt>AxisymmetryAxisVector</tt> contains (1,0), the <i>x</i>-axis is the
axis of rotation.

<p>
<tt>AxisymmetryAngle</tt> allows specification of the circumferential
extent about the axis of rotation.
If this angle is undefined, it is assumed to be 360&deg;.

<p>
<tt>CoordinateNames</tt> may be used to specify the first and second
coordinates used in the definition of <tt>AxisymmetryReferencePoint</tt>
and <tt>AxisymmetryAxisVector</tt>.
If not found, it is assumed that the first coordinate is
<tt>CoordinateX</tt> and the second is <tt>CoordinateY</tt>.
The coordinates given under <tt>CoordinateNames</tt>, or implied by
using the default, must correspond to those found under
<a href="#GridCoordinates"><tt>GridCoordinates_t</tt></a>.

<p>
<a href="build.html#DataClass"><tt>DataClass</tt></a> defines the default
class for numerical data contained in the
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> entities.
For dimensional data,
<a href="build.html#DimensionalUnits"><tt>DimensionalUnits</tt></a> may be
used to describe the system of units employed.
If present, these two entities take precedence over the corresponding
entities at higher levels of the CGNS hierarchy, following the
standard <a href="cgnsbase.html#precedence">precedence rules</a>.

<p>
The <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
data structure allows arbitrary user-defined data to be stored in
<tt>Descriptor_t</tt> and <tt>DataArray_t</tt> children without the
restrictions or implicit meanings imposed on these node types at other
node locations.

<a name="RotatingCoordinates"></a>
<h3>Rotating Coordinates Structure Definition: <tt>RotatingCoordinates_t</tt></h3>

<p>
The <tt>RotatingCoordinates_t</tt> data structure is used to record
the rotation center and rotation rate vector of a rotating coordinate
system.

<pre>
  RotatingCoordinates_t :=
    {
    List( Descriptor_t Descriptor1 ... DescriptorN ) ;                 (o)

    DataArray_t&lt;real,1,PhysicalDimension&gt; RotationCenter ;             (r)
    DataArray_t&lt;real,1,PhysicalDimension&gt; RotationRateVector ;         (r)

    DataClass_t DataClass ;                                            (o)

    DimensionalUnits_t DimensionalUnits ;                              (o)

    List( UserDefinedData_t UserDefinedData1 ... UserDefinedDataN ) ;  (o)
    } ;
</pre>

<i>Notes</i>

<ol>
<li> Default names for the
     <a href="build.html#Descriptor"><tt>Descriptor_t</tt></a> and
     <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
     lists are as shown; users may choose other legitimate names.
     Legitimate names must be unique within a given instance
     of <tt>RotatingCoordinates_t</tt> and shall not include
     the names <tt>DataClass</tt>, <tt>DimensionalUnits</tt>,
     <tt>RotationCenter</tt>, or <tt>RotationRateVector</tt>.
<li> <tt>RotationCenter</tt> and <tt>RotationRateVector</tt> are
     the required fields within the <tt>RotatingCoordinates_t</tt>
     structure.
</ol>

<p>
<tt>RotationCenter</tt> specifies the coordinates of the center of
rotation, and <tt>RotationRateVector</tt> specifies the components of
the angular velocity of the grid about the center of rotation.
Together, they define the angular velocity vector.
The direction of the angular velocity vector specifies the axis of
rotation, and its magnitude specifies the rate of rotation.

<p>
For example, for the common situation of rotation about the <i>x</i>-axis,
<tt>RotationCenter</tt> would be specified as any point on the <i>x</i>-axis,
like (0,0,0).
<tt>RotationRateVector</tt> would then be specified as (<i>&omega;</i>,0,0),
where <i>&omega;</i> is the rotation rate.
Using the right-hand rule, <i>&omega;</i> would be positive for clockwise
rotation (looking in the +<i>x</i> direction), and negative for
counter-clockwise rotation.

<p>
Note that for a rotating coordinate system, the axis of rotation is
defined in the inertial frame of reference, while the grid coordinates
stored using the <a href="#GridCoordinates"><tt>GridCoordinates_t</tt></a>
data structure are relative to the rotating frame of reference.

<p>
<a href="build.html#DataClass"><tt>DataClass</tt></a> defines the default
class for data contained in the
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> entities.
For dimensional data,
<a href="build.html#DimensionalUnits"><tt>DimensionalUnits</tt></a> may be
used to describe the system of units employed.
If present, these two entities take precedence over the corresponding
entities at higher levels of the CGNS hierarchy, following the
standard <a href="cgnsbase.html#precedence">precedence rules</a>.

<p>
The <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
data structure allows arbitrary user-defined data to be stored in
<tt>Descriptor_t</tt> and <tt>DataArray_t</tt> children without the
restrictions or implicit meanings imposed on these node types at other
node locations.

<p>
If rotating coordinates are used, it is useful to store variables
relative to the rotating frame.
Standardized data-name identifiers should be used for these
variables, as defined for flow-solution quantities in the section
<a href="dataname.html">Conventions for Data-Name Identifiers</a>.

<a name="FlowSolution"></a>
<h3>Flow Solution Structure Definition: <tt>FlowSolution_t</tt></h3>

<p>
The flow solution within a given zone is described by the
<tt>FlowSolution_t</tt> structure.
This structure contains a list for the data arrays of the individual
flow-solution variables, as well as identifying the grid location of the
solution.
It also provides a mechanism for identifying rind-point data included
within the data arrays.

<pre>
  FlowSolution_t&lt; int IndexDimension, int VertexSize[IndexDimension], 
                  int CellSize[IndexDimension] &gt; :=
    {
    List( Descriptor_t Descriptor1 ... DescriptorN ) ;                 (o)

    GridLocation_t GridLocation ;                                      (o/d)

    Rind_t&lt;IndexDimension&gt; Rind ;                                      (o/d)

    List( DataArray_t&lt;DataType, IndexDimension, DataSize[]&gt; 
          DataArray1 ... DataArrayN ) ;                                (o)

    DataClass_t DataClass ;                                            (o)
    
    DimensionalUnits_t DimensionalUnits ;                              (o)

    List( UserDefinedData_t UserDefinedData1 ... UserDefinedDataN ) ;  (o)
    } ;
</pre>

<i>Notes</i>

<ol>
<li> Default names for the
     <a href="build.html#Descriptor"><tt>Descriptor_t</tt></a>,
     <a href="data.html#DataArray"><tt>DataArray_t</tt></a>, and
     <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
     lists are as shown; users may choose other legitimate names.
     Legitimate names must be unique within a given instance
     of <tt>FlowSolution_t</tt> and shall not include the
     names <tt>DataClass</tt>, <tt>DimensionalUnits</tt>,
     <tt>GridLocation</tt>, or <tt>Rind</tt>.
<li> There are no required fields for <tt>FlowSolution_t</tt>.
     <a href="build.html#GridLocation"><tt>GridLocation</tt></a> has a
     default of <tt>Vertex</tt> if absent.
     <a href="build.html#Rind"><tt>Rind</tt></a> also has a default if
     absent; the default is equivalent to having an instance of
     <tt>Rind</tt> whose <tt>RindPlanes</tt> array contains all zeros.
<li> The structure parameter <tt>DataType</tt> must be consistent with
     the data stored in the
     <a href="data.html#DataArray"><tt>DataArray_t</tt></a>
     structure entities; <tt>DataType</tt> is
     <tt>real</tt> for all flow-solution identifiers defined in
     the section <a href="dataname.html">Conventions for Data-Name
     Identifiers</a>.
<li> For unstructured zones
     <a href="build.html#GridLocation"><tt>GridLocation</tt></a>
     options are limited to <tt>Vertex</tt> or <tt>CellCenter</tt>,
     meaning that solution data may only be expressed at these
     locations.
     The data arrays must follow the node ordering if
     <tt>GridLocation&nbsp;=&nbsp;Vertex</tt>, and the element ordering
     if <tt>GridLocation&nbsp;=&nbsp;CellCenter</tt>.
</ol>

<p>
<tt>FlowSolution_t</tt> requires three structure parameters;
<tt>IndexDimension</tt> identifies the dimensionality of the grid-size
arrays, and <tt>VertexSize</tt> and <tt>CellSize</tt> are the number of
core vertices and cells, respectively, in each index direction.
For unstructured zones, <tt>IndexDimension</tt> is always 1.

<p>
The flow solution data is stored in the list of
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> entities; each
<tt>DataArray_t</tt> structure entity may contain a single component of
the solution vector.
Standardized data-name identifiers for the flow-solution quantities are
described in the section <a href="dataname.html">Conventions for Data-Name
Identifiers</a>.
The field <a href="build.html#GridLocation"><tt>GridLocation</tt></a>
specifies the location of the solution data with respect to the grid;
if absent, the data is assumed to coincide with grid vertices (i.e.,
<tt>GridLocation = Vertex</tt>).
All data within a given instance of <tt>FlowSolution_t</tt> must reside
at the same grid location.

<p>
<a href="build.html#Rind"><tt>Rind</tt></a> is an optional field
that indicates the number of rind planes (for
structured grids) or rind points or elements (for unstructured grids)
included in the data.
Its purpose and function are identical to those described for the
<a href="#GridCoordinates"><tt>GridCoordinates_t</tt></a> structure.
Note, however, that the <tt>Rind</tt> in this structure is independent
of the <tt>Rind</tt> contained in <tt>GridCoordinates_t</tt>.
They are not required to contain the same number of rind planes or
elements.
Also, the location of any flow-solution rind points is assumed to be
consistent with the location of the core flow solution points (e.g.,
if <tt><a href="build.html#GridLocation">GridLocation</a> = CellCenter</tt>,
rind points are assumed to be located at fictitious cell centers).

<p>
<a href="build.html#DataClass"><tt>DataClass</tt></a> defines the default
class for data contained in the
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> entities.
For dimensional flow solution data,
<a href="build.html#DimensionalUnits"><tt>DimensionalUnits</tt></a> may be
used to describe the system of units employed.
If present, these two entities take precedence over the corresponding
entities at higher levels of the CGNS hierarchy, following the
standard <a href="cgnsbase.html#precedence">precedence rules</a>.

<p>
The <a href="misc.html#UserDefinedData"><tt>UserDefinedData_t</tt></a>
data structure allows arbitrary user-defined data to be stored in
<tt>Descriptor_t</tt> and <tt>DataArray_t</tt> children without the
restrictions or implicit meanings imposed on these node types at other
node locations.

<a name="DataSize_flow"></a>
<h4>FUNCTION <tt>DataSize[]</tt>:</h4>

return value: one-dimensional <tt>int</tt> array of length <tt>IndexDimension</tt>
<br>
dependencies: <tt>IndexDimension</tt>, <tt>VertexSize[]</tt>, <tt>CellSize[]</tt>, <tt>GridLocation</tt>,
<tt>Rind</tt>

<p>
The function <tt>DataSize[]</tt> is the size of flow solution data arrays.
If <a href="build.html#Rind"><tt>Rind</tt></a> is absent then
<tt>DataSize</tt> represents only the core points; it will be
the same as <tt>VertexSize</tt> or <tt>CellSize</tt> depending on
<a href="build.html#GridLocation"><tt>GridLocation</tt></a>.  The
definition of the function <tt>DataSize[]</tt> is as follows:

<pre>
  if (Rind is absent) then
    {
    if (GridLocation = Vertex) or (GridLocation is absent)
      {
      DataSize[] = VertexSize[] ;
      }
    else if (GridLocation = CellCenter) then
      {
      DataSize[] = CellSize[] ;
      }
    }
  else if (Rind is present) then
    {
    if (GridLocation = Vertex) or (GridLocation is absent) then
      {
      DataSize[] = VertexSize[] + [a + b,...] ;
      }
    else if (GridLocation = CellCenter)
      {
      DataSize[] = CellSize[] + [a + b,...] ;
      }
    }
</pre>
where <tt>RindPlanes = [a,b,...]</tt> (see the
<a href="build.html#Rind"><tt>Rind_t</tt></a> structure for the     
definition of <tt>RindPlanes</tt>).

<a name="flow_example"></a>
<h3>Flow Solution Example</h3>

<p>
This section contains an example of the flow solution entity, including
the designation of grid location and rind planes and data-normalization
mechanisms.

<a name="ex:flow"></a>
<h4>Example - Flow Solution</h4>

<p>
Conservation-equation variables (<i>&rho;</i>, <i>&rho;u</i>, <i>&rho;v</i>, 
and <i>&rho;e</i><sub>0</sub>)
for a 2-D grid of size 11 &times; 5.
The flowfield is cell-centered with two planes of rind data.
The density, momentum and stagnation energy
(<i>&rho;e</i><sub>0</sub>)
data is nondimensionalized with respect to a freestream reference state
whose quantities are dimensional.
The freestream density and pressure are used for normalization; these
values are 1.226 kg/m<sup>3</sup> and
1.0132&times;10<sup>5</sup> N/m<sup>2</sup> (standard atmosphere conditions).
The data-name identifier conventions for the conservation-equation
variables are <tt>Density</tt>, <tt>MomentumX</tt>, <tt>MomentumY</tt>
and <tt>EnergyStagnationDensity</tt>.
<pre>
  !  IndexDimension = 2
  !  VertexSize = [11,5]
  !  CellSize = [10,4]
  FlowSolution_t&lt;2, [11,5], [10,4]&gt; FlowExample =
    {{
    GridLocation_t GridLocation = CellCenter ;

    Rind_t&lt;2&gt; Rind =
      {{
      int[4] RindPlanes = [2,2,2,2] ;
      }} ;

    DataClass_t DataClass = NormalizedByDimensional ;
    
    DimensionalUnits_t DimensionalUnits = 
      {{ 
      MassUnits        = Kilogram ;
      LengthUnits      = Meter ;
      TimeUnits        = Second ;
      TemperatureUnits = Null ;
      AngleUnits       = Null ;
      }} ;

    !  DataType = real
    !  Dimension = 2
    !  DataSize = CellSize + [4,4] = [14,8]
    DataArray_t&lt;real, 2, [14,8]&gt; Density =
      {{
      Data(real, 2, [14,8]) = ((rho(i,j), i=-1,12), j=-1,6) ;

      DataConversion_t DataConversion =
        {{
        ConversionScale  = 1.226 ;
        ConversionOffset = 0 ;
        }} ;

      DimensionalExponents_t DimensionalExponents =
        {{
        MassExponent        = +1 ;
        LengthExponent      = -3 ;
        TimeExponent        =  0 ;
        TemperatureExponent =  0 ;
        AngleExponent       =  0 ;
        }} ;
      }} ;

    DataArray_t&lt;real, 2, [14,8]&gt; MomentumX =
      {{
      Data(real, 2, [14,8]) = ((rho_u(i,j), i=-1,12), j=-1,6) ;

      DataConversion_t DataConversion =
        {{
        ConversionScale  = 352.446 ;
        ConversionOffset = 0 ;
        }} ;
      }} ;

    DataArray_t&lt;real, 2, [14,8]&gt; MomentumY =
      {{
      Data(real, 2, [14,8]) = ((rho_v(i,j), i=-1,12), j=-1,6) ;

      DataConversion_t DataConversion =
        {{
        ConversionScale  = 352.446 ;
        ConversionOffset = 0 ;
        }} ;
      }} ;

    DataArray_t&lt;real, 2, [14,8]&gt; EnergyStagnationDensity =
      {{
      Data(real, 2, [14,8]) = ((rho_e0(i,j), i=-1,12), j=-1,6) ;

      DataConversion_t DataConversion =
        {{
        ConversionScale  = 1.0132e+05 ;
        ConversionOffset = 0 ;
        }} ;
      }} ;
    }} ;
</pre>
The value of <a href="build.html#GridLocation"><tt>GridLocation</tt></a>
indicates the data is at cell centers, and the value of
<a href="build.html#Rind"><tt>RindPlanes</tt></a> specifies two rind
planes on each face of the zone.
The resulting value of the structure function
<a href="#DataSize_flow"><tt>DataSize</tt></a> is the number of cells
plus four in each coordinate direction; this value is passed to each of
the <a href="data.html#DataArray"><tt>DataArray_t</tt></a> entities.

<p>
Since the data are all nondimensional and normalized by dimensional
reference quantities, this information is stated in
<a href="build.html#DataClass"><tt>DataClass</tt></a> and
<a href="build.html#DimensionalUnits"><tt>DimensionalUnits</tt></a>
at the <a href="#FlowSolution"><tt>FlowSolution_t</tt></a> level
rather than attaching the appropriate <tt>DataClass</tt> and
<tt>DimensionalUnits</tt> to each
<a href="data.html#DataArray"><tt>DataArray_t</tt></a> entity.
It could possibly be at even higher levels in the heirarchy.
The contents of <a href="data.html#DataConversion"><tt>DataConversion</tt></a>
are in each case the denominator of the normalization; this is
<i>&rho;</i><sub>&infin;</sub>
for density,
(<i>p</i><sub>&infin;</sub> <i>&rho;</i><sub>&infin;</sub>)<sup>1/2</sup>
for momentum, and
<i>p</i><sub>&infin;</sub>
for stagnation energy.
The dimensional exponents are specified for density.
For all the other data, the dimensional exponents are to be inferred
from the data-name identifiers.

<p>
Note that no information is provided to identify the actual reference
state or indicate that it is freestream.
This information is not needed for data manipulations involving
renormalization or changing the units of the converted raw data.

<p>
<hr size=4 width=75%>
<div class=footer>
<!--#include virtual="../include/footer_small.html" -->
Last updated 28 July 2006

</body>
</html>
